\documentclass[12pt,letterpaper]{amsbook}

% Formatting packages
\usepackage[utf8]{inputenc}
\usepackage[margin=1 in]{geometry}
\usepackage{parskip}

% Picture packages
\usepackage{graphicx}
\usepackage[justification=centering]{caption}

%AMS packages
\usepackage{amsmath,amsthm,amsfonts,amssymb,mathtools}

% Formatting
\renewcommand{\baselinestretch}{1.25}

% Theorems and other necessary structures
\usepackage{mdframed}
\mdfsetup{skipabove=1em,skipbelow=0em}
\theoremstyle{definition}
\newmdtheoremenv[nobreak=true]{theorem}{Theorem}[section] % Big result
\newmdtheoremenv[nobreak=true]{corollary}{Corollary}[theorem] % Follows from a theorem
\newmdtheoremenv[nobreak=true]{lemma}[theorem]{Lemma} % Minor result
\newtheorem{definition}{Definition} % Definition
\newtheorem*{remark}{Remark}
\newtheorem*{exercise}{Exercise}

\newenvironment{solution}
  {\renewcommand\qedsymbol{$\blacksquare$}\begin{proof}[Solution]}
  {\end{proof}}

% New commands
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\C}{\mathbb{C}}

% Title information
\title{Number Theory}
\author{2018A7PS0193P}

\begin{document}

\maketitle

\chapter{Fundamentals}

\section{Notation}

For the rest of this course, the following notation will be followed:

\begin{enumerate}
  \item $\N$ is the set of natural numbers
  \item $\Z$ is the set of integers
  \item $\mathbb{W}$ is the set of whole numbers, i.e. $\mathbb{W} = \N \cup \{0\}$
\end{enumerate}

\section{Induction}

Often in number theory, we use inductive proofs to prove our arguments. Induction consists of the following steps:

\begin{enumerate}
  \item Define an induction hypothesis $P(k)$
  \item Verify it works for some base case $k=b$. It is possible multiple base cases need to be verified.
  \item Assuming $P(k)$ is true, show that it implies that $P(k+1)$ is true
\end{enumerate}

Remember that $P(k)$ is a statement, not a function. You cannot multiply it by some constant or perform any operations on it.

In weak induction (like in the steps given above), we only assume that $P(k)$ is true. However in strong induction, we assume that $P(i)$ is true $\forall i \in [b,k]$, and use this to prove that $P(k+1)$ is true.

\begin{exercise}
  Prove that the principle of strong induction is true given that the principle of weak induction is true.
\end{exercise}
\begin{solution}
  Let us assume that $P(1),...,P(b)$ is true. If $P(1),...,P(k)$ are true for some $k \geq b$, then $P(k+1)$ is true. Then, we must show that $P(n)$ is true for all $n \geq 1$. 

  Let $Q(n)$ be the statement that $P(1),...P(n)$ are true. Of course, in the base case, $Q(1)$ is true. Let $Q(k)$ be true, where $K \geq 1$. This means that $P(1),...P(k)$ is true, so $P(k+1)$ must be true. Hence, $Q(k+1)$ is true.

  So, by Weak induction, $Q(n)$ is true $\forall n \geq 1$, which implies that $P(n)$ is true $\forall n \geq 1$.
\end{solution}

\section{Well Ordering Principle}

\phantom{}

\begin{theorem}[Well Ordering Principle]
  Every non empty set of non-negative integers has a least element.
\end{theorem}

This is not true about negative integers - consider the case of infinite sets, like the set of all integers. There is no well defined least element.

\begin{lemma}
The well ordering principle is equivalent to the principle of mathematical induction.
\end{lemma}

\begin{proof}
First, let us prove that WOP $\Rightarrow$ PMI. Let $P(n)$ be a statement that depends on $n \in \N$. Suppose that:

\begin{itemize}
  \item $P(1)$ is true
  \item $P(k)$ is true implies $P(k+1)$ is true for all $k \in N$.
\end{itemize}

We have to show that $P(n)$ is true for all $n \in N$. Let :

\[S = \{n \in \N : P(n) \text{ is true} \}\]

This means we must show that $S = \N$. Let $T := \N \symbol{92} S$, i.e. $T$ is the complement. Let as assume that $S \neq \N$.

By WOP, $T$ has a least element, say $m$. Note that $m \geq 2$ since $1 \in S$. Then, $m-1 \notin T$ and $m-1 \in S$. As such, $P(m-1)$ must be true! However, by our initial assumptions, that would mean $P(m)$ is true as well, so $m \in S$. This creates a contradiction, since $m \in T$. Hence, $S = \N$.

Now, let us prove that PMI $\Rightarrow$ WOP.

Consider the statement $P(n)$ that every non empty set of non-negative integers of size $n$ has a least element. It is clear that the base case $P(1)$ is true. Now, let us assume that $P(k)$ is true - what can we say about $P(k+1)$. When we insert an element, we have two cases:

\begin{enumerate}
  \item The inserted element is less than the least element. In this case, there is a new least element, and $P(k+1)$ is true.
  \item The inserted element is not less than the least element. In this case, the least element is the same, and $P(k+1)$ is true.
\end{enumerate}

Hence, by PMI, we can say that $P(n)$ is true $\forall n \in N$, i.e., WOP is true.

Since PMI $\Rightarrow$ WOP and WOP $\Rightarrow$ PMI, PMI $\Leftrightarrow$ WOP.
\end{proof}

\section{Binomial Theorem}

\phantom{}

\begin{theorem}[Binomial Theorem]
  Let $x,y \in \C$ and let $n \in \N$, then 
  \[(x+y)^n = \sum_{k=0}^{n} {n \choose k} x^ky^{n-k}\]
\end{theorem}


\begin{corollary}
  \[\sum_{k=0}^n {n \choose k} = 2^n\]
\end{corollary}

\begin{lemma}[Pascal's Identity]
  \[{n \choose k} = {n-1 \choose k-1} + {n-1 \choose k}\]
\end{lemma}

\begin{lemma}
  \[\sum_{k=0}^{\left \lfloor n/2 \rfloor \right} {n-k \choose k} = F_n\]
\end{lemma}

\phantom{}

\section{Pigeonhole Principle}

\phantom{}

\begin{theorem}
  If $n$ items are put into $m$ containers, with $n > m$, then at least one container must contain more than one item.
\end{theorem}

\chapter{Division}

\section{Division Algorithm}

\phantom{}

\begin{theorem}
  Let $a,b \in \Z$ with $b > 0$. Then, there exist unique integers $q$ and $r$ such that $a = bq + r$, $r \in [0,b)$.
\end{theorem}

\begin{proof}

Let $S = \{a - bn : n \in Z, a-bn \geq 0\}$. This set is always non-empty:
\begin{itemize}
  \item If $a \geq 0$, then $a \in S$
  \item If $a<0$, then if $n = a$, we have $a-ab \in S$ since $b \geq 1$.
\end{itemize}

By WOP, $S$ has a least element, say $r$. So, there exists $q \in Z$ such that $r = a-bq$. Since $r \in S$, we have $r \geq 0$.

Suppose $r \geq b$. Then:

\[a-b(q+1) = a-bq-b = r-b \geq 0\]
\[ \Rightarrow a-b(q+1) \in S\]
\[\Rightarrow r-b \in S\]

However, $r-b < r$, and $r$ is the least element! This gives us a contradiction. So, $r < b$.

As such, we have proved the existence of this solution. Now we must prove it's uniqueness.

Suppose there exists $p,r,q',r'$, such that:
\[a = bq+r, 0 \leq r < b\]
\[a = bq'+r', 0 \leq r' < b\]

Assume WLOG $q \geq q'$. Now,
\[r'-r = b(q-q')\]
If $q > q'$, then $r'-r \geq b$. However, $r'-r < b$. So, this is a contradiction, and $q' = q$. The solution must be unique.

\end{proof}

\begin{definition}
  If $a,b \in \Z$, we say that $a$ divides $b$ if $b=ak$ for some $k \in \Z$. This is denoted by $a|b$
\end{definition}

Some properties of division are:

\begin{itemize}
  \item If $a|b$, then $\pm a | \pm b$
  \item If $a|b$ and $b|c$ then $a|c$ (Transitivity)
  \item If $a|b$ and $a|c$ then $a|bx+cy$ (Linear Combination)
  \item If $a|b$ and $b \neq 0$, then $|a| \leq |b|$ (Bounds by divisibility)
  \item $a|b$ and $b|a$, then $b = \pm a$.
\end{itemize}

\section{Base b representations}

\phantom{}

\begin{theorem}
  Let $b \in \N$   with $b \geq 2$. Then every positive integer can be expressed uniquely as 
  \[N = a_kb^k + ...+a_1b+a_0\]
  where $k \geq 0, a_k \neq 0$ and $0 \leq a_i < b$ for $i = 0,...k$. This is denoted by $N = (a_k,...a_1a_0)_b$
\end{theorem}

\begin{proof}
  By the division algorithm, there exist unique integers $q_0$ and $a_0$ such that:
  \[N = q_0b + a_0, a_0 \in [0,b)\]
  Note that $q_0 < N$. If $q_0 \neq 0$ we apply the division algorithm again to find unique integers $q_1$ and $a_q$ such that:
  \[q_0 = q_1b + a_1, a_1 \in [0,b)\]
  Then,
  \[N = (q_1b+a_1)b+a_0 = q_1b^2 + a_1b + a_0\]
  We continue till we get a quotient $q_k = 0$. This will terminate since $q_k < ... < q_2 < q_1 < q_0 < N$, forming a decreasing sequence of non-negative integers and eventually reaching zero. From this, we get:
  \[N = a_kb^k + ... + a_1b + a_0\]
  Hence, the solution always exists.

  Suppose $N$ has two distinct expansions. We can write it as:
  \begin{align*}
    N &= a_kb^k + ... + a_1b + a_0 \\
      &= c_kb^k + ... + c_1b + c_0
  \end{align*}
  where $0 \leq a_i,c_j < b$ for all $i,j$. Let $d_i = a_i-c_i$. Then, $\sum_{i=0}^k d_ib^i = 0$. The $d_i$ cannot all be zero as the two expansions are assumed distinct. Let $j$ be the least integer, $0 \leq j \leq k$, such that $d_j \neq 0$. Then, $\sum_{i=j}^k d_ib^i = 0$. Dividing by $b^j$, we find that $\sum_{i=j}^k d_ib^{i-j} = 0$. Thus,
  \[d_j + b \left( \sum_{i = j+1}^{k} d_i b^{i-j-1} \right) = 0\]
  This implies that the $b | d_j$ and since $d_j \neq 0$, we get that $b = |b| \leq |d_j|$. However, $|d_j| < b$. Hence, we have a contradiction, and the two expansions cannot be distinct.
  Hence, the solution is also always unique.
\end{proof}

\begin{lemma}
  If $N = (a_k...a_1a_0)_b$, then:
  \[bN = (a_k...a_1a_00)_b\]
  \[\Bigl \lfloor \frac{N}{b} \Bigr \rfloor = (a_k...a_1)_b\]
\end{lemma}

This is a trivial result, which can be thought of as a left or right bitwise shift.

\begin{lemma}[Particular case of Legendre's formula]
  Let $n \in \N$ and let $e$ denote the highest power of 2 dividing $n!$. Then
  \[e = \sum_{k=1}^{\infty} \Bigl \lfloor \frac{n}{2^k} \Bigr \rfloor\]
  This is always a finite sum. This can alternatively expressed as, if $n = (a_k...a_1a_0)_2$, then:
  \[e = n - (a_k + ... + a_1 + a_0)\]
\end{lemma}
\begin{proof}
  It is clear that $e$ is the sum of the no. of positive multiples of $2^i$ which are $\leq n$, for all $i$. So, this can be calculated by:
  \begin{align*}
    e = \sum_{k=1}^{\infty} \Bigl \lfloor \frac{n}{2^k} \Bigr \rfloor    
  \end{align*}
\end{proof}

Thus, if $r$ denotes the number of ones in the binary expansion of $n$, then $2^{n-r}$ is the highest power of 2 dividing $n!$. Further,
\begin{itemize}
  \item $2^n \nmid n!$ for $n \in \N$
  \item $2^{n-1} | n!$ if and only if $n$ is a power of 2.
\end{itemize}

\chapter{Properties of Numbers}

\section{Prime and Composite Numbers}

\begin{definition}
  A positive integer $p > 1$ is called prime if its only positive divisors are 1 and $p$. A positive integer which is not prime is called composite.  
\end{definition}

The number 1 is neither prime nor composite.

\begin{lemma}
  Every integer $n \geq 2$ has a prime factor.
\end{lemma}

\begin{proof}
  Let $P(n)$ be the statement that $n$ has a prime factor. Then $P(2)$ is true, since 2 is a prime factor of 2. Let $k \geq 2$. Assume $P(2)...P(k)$ are true.

  If $k+1$ is prime, then $k+1$ is a prime factor of itself. So $P(k+1)$ is true.

  If $k+1$ is composite, then there exists $d \in [2,k]$ such that $d | k+1$. By the induction hypothesis, $d$ has a prime factor $p$. Since $p|d$ and $d|k+1$, $p|k+1$. So $p$ is a prime factor of $k+1$, and $P(k+1)$ is true. By PSI, $P(n)$ is true for all $n \geq 2$.
\end{proof}

\begin{theorem}[Euclid]
  There are infinitely many primes.  
\end{theorem}

\begin{proof}
  Suppose there are finitely many primes $p_1,...,p_k$. Let
  \[N = p_1...p_k + 1\]
  Since $N \geq 2$, it must have a prime factor. Hence, there exists $i \in [1,k]$ such that $p_i | N$. Since $p_i|N$ and $p_i|p_1p_2...p_k$, we get that $p_i|N-p_1p_2...p_k$, i.e., $p_i|1$. However, $p_i \geq 2$, which gives us a contradiction. So, there must be infinitely many primes.
\end{proof}

\begin{exercise}
  For $n \geq 1$, let $p_n$ be the $n$th prime. Prove that
  \[p_n \leq 2^{2^{n-1}}\]
\end{exercise}

\begin{solution}
  Let $P(n)$ be the statement that $p_n \leq 2^{2^{n-1}}$. It is clear that this is true for the base case $P(1)$. Let us assume that $P(1),...,P(k)$ is true for $k \geq 1$.
  We observed in Euclid's proof that $p_1...p_k+1$ is not divisible by any of $p_1...p_k$. Hence if $p_i$ denotes a prime factor of $p_1...p_k+1$, then $i \geq k+1$.
  \[p_{k+1} \leq p_i \leq p_1...p_k+1\]
  Using the inductive hypothesis, we find that
  \begin{align*}
    p_{k+1} &\leq p_1...p_k+1 \leq 2.2^2.2^{2^2}...2^{2^{k-1}}+1 \\
            &= 2^{\sum_{j=0}^{k-1} 2^j}+1 = 2^{2^k-1}+1 \leq 2^{2^k}
  \end{align*}
  So, $P(k+1)$ is true. So, by PSI, the result has been proven.
\end{solution}

\begin{definition}
  The product of the first $n$ prime numbers is called the $n^{th}$ primorial and is denoted by $p_n\#$.
\end{definition}

\begin{definition}
  Euclid numbers are integers of the form $E_n = p_n\# +1$. 
\end{definition}

All Euclid numbers are not primes - $E_6$ is not a prime!

\begin{theorem}
  Every composite number $n$ has a prime factor $\leq \lfloor \sqrt{n} \rfloor$
\end{theorem}

\begin{proof}
  Since $n$ is composite, there exists integers $k,l \in (1,n)$   such that 
  \[n = kl\]
  If $k > \sqrt{n}$ and $l > \sqrt{n}$ then $kl > n$, which is false. So, one of them must be less than or equal to $\sqrt{n}$.
\end{proof}

So, if $n > 1$ has no prime factors $\leq \lfloor \sqrt{n} \rfloor$, then $n$ is prime. We can use this as a test of primality.

It is faster to do this using the Sieve of Eratosthenes. Using this, we can test primality of the first $n$ integers in $O(n \log{\log{n}})$ instead of $O(n\sqrt{n})$. This is a pretty well known algorithm so it's left to the reader to see it on cp-algorithms.

\begin{theorem}
  There is no non-constant polynomial $f(x)$ with integer coefficients such that $f(n)$ is prime for all integer $n$.  
\end{theorem}

\begin{proof}
  Suppose such a polynomial $f(x)$ exists:
  \[f(x) = a_kx^k + ... + a_1x + a_0, k \geq 1, a_k \neq 0\]
  Let $b \in \Z$. Then $f(b)$ is a prime number, say $p$. Let $t \in \Z$. We have:
  \begin{align*}
    f(b+tp) &= a_k(b+tp)^k + ... + a_1(b+tp) + a_0 \\
            &= (a_kb^k + ... a_1b + a_0) + p \cdot g(t) \\
            &= f(b) + p \cdot g(t) = p(1+g(t))
  \end{align*}
  where $g(t)$ is a polynomial in $t$. Since $p | f(b+tp)$ and it must be prime, so $f(b+tp) = p$. This implies that $f$ assumes the value $p$ infinitely many times. This is a contradiction, since a polynomial of degree $k$ cannot assume the same value > $k$ times.
\end{proof}

\section{Prime Counting function}
Let $x$ be a positive real number. We define :
\[\pi (x) = \sum_{p \leq x} 1\]
where $p$ denotes a prime. So $\pi (x)$ counts the number of primes $\leq x$. This is called the prime counting function.

\begin{theorem}[Prime Number Theorem]
  \[\lim_{x \rightarrow \infty} \frac{\pi (x)}{x/\log{x}} = 1\]
\end{theorem}

This essentially states that $\pi (x) \sim \frac{x}{\log{x}}$. The proof is too complicated to be covered in this course.

\section{Gaps between Primes}

The following lemma states that we can find a gap between primes of any arbitrary length.

\begin{lemma}
  For every $n \in \N$, there are $n$ consecutive integers that are all composite.  
\end{lemma}

\begin{proof}
  Consider the numbers:
  \[(n+1)! + 2, (n+1)! + 3, ... ,(n+1)!+(n+1)\]
  It is clear that for $n \geq 1$, $2|(n+1)!+2$. However, $(n+1)! + 2 \neq 2$. So, $(n+1)!+2$ cannot be prime, and must be composite. We can extend this to each of the given numbers, and prove that they are all composite.
\end{proof}

\begin{definition}
  A pair $(p,q)$ of primes with $p < q$ is called a twin prime pair if $q-p = 2$.  
\end{definition}

It is unknown how many twin primes exist. It is conjectured that there are infinitely many twin primes, but this has not yet been proved.

\begin{theorem}[Bertrand's Postulate]
  For every integer $n \geq 2$, there is always at least one prime between $n$ and $2n$.  
\end{theorem}

This was verified by Bertrand but proved by Chebyshev. It is sometimes called Chebyshev's theorem. The proof of this result goes beyond the scope of this course.

\begin{remark}
  Do not use this result unless mentioned that we can, in the exam .
\end{remark}

\begin{exercise}
  Using Bertrand's postulate, prove that for $n \geq 2$:
  \[p_n < 2^n\]
\end{exercise}

\begin{solution}
  Left as an exercise for me, TODO.
\end{solution}
\begin{exercise}
  Prove that if $2^{m}+1$ is prime, then $m = 2^n$ for some $n$.
\end{exercise}
\begin{solution}
  Here, we use the following lemma - if $k$ is odd, then $x^k+1$ is divisible by $x+1$.
  Suppose that $m$ has an odd factor $k$. Then, we can express $m$ as $kp$. So,
  \[2^{kp}+1 = (2^{p})^k + 1\]
  From our lemma, this is divisible by $2^p+1$ which is a number other than 1 and itself. This means $2^m+1$ cannot be prime if it has an odd factor, and hence $m$ must be a power of 2.
\end{solution}

\section{Fermat Numbers}

\begin{definition}
  Fermat numbers are $f_n$ such that:
  \[f_n = 2^{2^n}+1\]
\end{definition}

\begin{lemma}[Recursive definition]
  \[f_n = f_{n-1}^2 - 2f_{n-1} + 2\]  
\end{lemma}

This result is obvious from expanding the RHS, so the proof is not given here.

\begin{exercise}
  Prove that $f_n$, $n \geq 2$, all end in 7.
\end{exercise}
\begin{solution}
  Let $P(n)$ be the statement that $f_n$ ends in 7. This is true for our base case $P(2)$. Let us assume that $P(k-1)$ is true, i.e. $f_k \mod 10 = 7$. So, by the recursive definition:
  \begin{align*}
    f_k &= f_{k-1}^2 - 2f_{k-1} + 2 \mod 10 \\
        &= 7^2 - 2* 7 + 2 \mod 10 \\ 
        &= 7 \mod 10
  \end{align*}
  So, by PMI, $P(n)$ is true for all $n \geq 2$.
\end{solution}

\begin{lemma}[Duncan's Identity]
  \[f_0f_1...f_{n-1} = f_n - 2\]  
\end{lemma}
\begin{proof}
  Let $P(n)$ be the statement that this is true for $f_n$. This is clearly true for the base case $P(1)$. Let us assume $P(k)$ is true, i.e.
  \[f_0f_1...f_{k-1} = f_k - 2\]
  \[f_0f_1...f_k = f_k(f_k-2) = f_k^2-2f_k = f_{k+1}-2\]
  The above result comes from the recursive definition. Since $P(k+1)$ follows from $P(k)$, by PMI, Duncan's identity is true.
\end{proof}

\begin{theorem}
  Every prime factor of $f_n$, $n \geq 2$, is of the form $k \cdot 2^{n+2} + 1$.
\end{theorem}
\begin{proof}
  To be discussed later in the course.  
\end{proof}

This theorem can be helpful to quickly find the primality of $f_n$. For instance, $f_4$ is prime - we can see this by checking all the numbers of the form $2^6 k+1$ which are less than $\sqrt{f_4}$. This cuts down the search space and makes primality checking faster.

\section{Fibonacci Numbers}

\begin{definition}
  Fibonacci numbers are numbers of the form:
  \[F_n = F_{n-1} + F_{n-2}\]
  where $F_1 = 1, F_2 = 1$
\end{definition}

\begin{lemma}
  \[\sum_{i=1}^{k} F_i = F_{k+2}-1\]
\end{lemma}
This comes directly from induction, so I have not included the proof here.

\begin{lemma}[Cassini's Formula]
  \[F_{n-1}F_{n+1} - F_n^2 = (-1)^n, n \geq 2\]
\end{lemma}
\begin{proof}
  Let us prove this by PMI. The base case of $P(2)$ is obviously true. Let us assume $P(k)$ is true, then:
  \[F_{k-1}F_{k+1} - F_{k}^2 = (-1)^k\]
  Will include proof later, lazy today.
\end{proof}

\section{Lucas Numbers}

\begin{definition}
  Lucas numbers are numbers $L_n$ such that:
  \[L_n =L_{n-1} + L_{n-2}\]
  where L_1 = 1, L_2 = 3.
\end{definition}

\begin{theorem}[Binet's formulas]
  Let $\alpha = \frac{1+\sqrt 5}{2}$ and $\beta = \frac{1-\sqrt 5}{2}$.
  \[F_n = \frac{\alpha^n-\beta^n}{\alpha-\beta}\]
  \[L_n = \alpha^n + \beta^n\]
\end{theorem}
\begin{proof}
 TODO  
\end{proof}

\end{document}
